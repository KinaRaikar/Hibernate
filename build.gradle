apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'idea'

mainClassName='com.kiran.app.Application'

sourceCompatibility=1.8
targetCompatibility=1.8

repositories {
	mavenCentral()
}

dependencies {
	compile "org.projectlombok:lombok:1.16.10"
	compile "mysql:mysql-connector-java:5.1.16"
	compile "org.hibernate:hibernate-gradle-plugin:5.2.9.Final"
	testCompile "junit:junit:4.12"
	testCompile "org.hamcrest:hamcrest-all:1.3"
}

jar {
	baseName = "app"
	version = "0.1.0"
    from ("src/resources") {
        include ("hibernate.cfg.xml")
        into ("")
    }
    /* This is required to add all the dependencies into the application jar file	
    from {
		configurations.runtime.collect {
			it.isDirectory() ? it : zipTree(it)
		}
	}
	*/
	manifest {
		attributes 'Main-Class': mainClassName,
                   'Class-Path': configurations.runtime.files.collect { "lib/$it.name"}.join(' ')
        
	}
}

/* This is to copy all the dependency jars to lib folder parallel to application jar file */
task copyToLib(type: Copy) {
    into "$buildDir/libs/lib"
    from configurations.runtime
}

build.dependsOn(copyToLib)
